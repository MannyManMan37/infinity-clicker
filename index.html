<!DOCTYPE html>
<html>
<head>
    <title>Infinity Clicker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="code.png" type="image/x-icon" />
    <style>
        body { 
            background-image: url("yo.jpg"); 
            color: white; 
            font-family: "Segoe UI", sans-serif; 
            display: flex; 
            flex-direction: row;
            margin: 0; 
            height: 100vh;  
            background-size: cover; 
            background-position: center; 
            background-repeat: no-repeat; 
        }
        .sidebar {
            width: 280px;
            background: rgba(0,0,0,0.85);
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-right: 2px solid gold;
        }
        #idk, #rebirthCounter, #prestigePoints {
            background: rgba(0,0,0,0.5);
            border: 2px solid gold;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.3rem;
        }
        .sidebar button {
            min-height: 50px;
            font-size: 1.2rem;
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
        }
        .shop {
            flex: 1;
            padding: 20px;
            background: rgba(0,0,0,0.6);
            overflow-y: auto;
        }
        .shop-item {
            background: rgba(0,0,0,0.6);
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
        }
        .credits-box {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%,-50%);
            background: rgba(0,0,0,0.95);
            padding: 20px;
            border-radius: 12px;
            z-index: 1000;
            width: 380px;
        }
        #overlay {
            display: none;
            position: fixed;
            top:0;left:0;
            width:100%;
            height:100%;
            background: rgba(0,0,0,0.7);
            z-index: 900;
        }
    </style>
</head>
<body>

<div class="sidebar">
    <h1>Infinity Clicker</h1>
    <p id="idk">Clicks: 0</p>
    <p id="rebirthCounter">Rebirths: 0</p>
    <p id="prestigePoints">Premium Coins: 0</p>

    <button onclick="clickHandler()">Click</button>
    <button onclick="rebirth()">Rebirth</button>
    <button onclick="showCredits()">Credits</button>
    <button onclick="showPatch()">Patch Notes</button>
    <button onclick="showQuests()">Daily Quests</button>
    <button onclick="showAchievementsMenu()">Achievements</button>
    <button onclick="showStats()">Stats</button>
</div>

<div class="shop"><h2>Shop</h2></div>

<div id="overlay" onclick="closeAllModals()"></div>

<div id="questsBox" class="credits-box">
    <h2>Daily Quests</h2>
    <div id="questsContent"></div>
    <button onclick="closeAllModals()">Close</button>
</div>

<div id="achievementPopup"></div>

<!-- AVG CPS -->
<div id="avgCPS" style="position:fixed;top:10px;right:10px;
background:rgba(0,0,0,0.7);
border:2px solid gold;
padding:8px 12px;
border-radius:8px;">
Avg CPS: 0.00
</div>

<script>
let x = parseInt(localStorage.getItem("x")) || 0;
let clickPower = parseInt(localStorage.getItem("clickPower")) || 1;
let rebirths = parseInt(localStorage.getItem("rebirths")) || 0;
let rebirthMultiplier = parseInt(localStorage.getItem("rebirthMultiplier")) || 1;
let autoClickers = parseInt(localStorage.getItem("autoClickers")) || 0;
let critChance = parseFloat(localStorage.getItem("critChance")) || 0;
let prestigePoints = parseInt(localStorage.getItem("prestigePoints")) || 0;
let totalClicks = parseInt(localStorage.getItem("totalClicks")) || 0;
let critsTriggered = parseInt(localStorage.getItem("critsTriggered")) || 0;
let startTime = parseInt(localStorage.getItem("startTime")) || Date.now();
let lastOnline = parseInt(localStorage.getItem("lastOnline")) || Date.now();

/* AVG CPS */
function updateAvgCPS(){
    const seconds = Math.max(1, Math.floor((Date.now()-startTime)/1000));
    document.getElementById("avgCPS").innerText =
        `Avg CPS: ${(totalClicks/seconds).toFixed(2)}`;
}

/* OFFLINE PROGRESS */
(function(){
    const now = Date.now();
    const secs = Math.floor((now-lastOnline)/1000);
    if(secs>10){
        const gain = secs*(autoClickers+1)*rebirthMultiplier;
        x+=gain; totalClicks+=gain;
    }
    localStorage.setItem("lastOnline",now);
})();

/* QUEST SYSTEM */
let dailyQuests = JSON.parse(localStorage.getItem("dailyQuests")) || [];
let dailyQuestsClaimed = JSON.parse(localStorage.getItem("dailyQuestsClaimed")) || [false,false,false];
let lastQuestDay = localStorage.getItem("lastQuestDay") || "";

const questPool=[];
for(let i=1;i<=50;i++){
    questPool.push({
        description:`Earn ${i*1000} clicks`,
        goal:i*1000
    });
}

function generateDailyQuests(){
    const today=new Date().toDateString();
    if(today!==lastQuestDay){
        dailyQuests=[];
        dailyQuestsClaimed=[false,false,false];
        const shuffled=[...questPool].sort(()=>0.5-Math.random());
        for(let i=0;i<3;i++){
            const q=JSON.parse(JSON.stringify(shuffled[i]));
            q.progress=0;
            q.rewardClicks=Math.floor(q.goal*(1+rebirths*0.5));
            q.rewardPP=Math.floor(1+rebirths/2);
            dailyQuests.push(q);
        }
        lastQuestDay=today;
        saveData();
    }
}

function showQuests(){
    generateDailyQuests();
    overlay.style.display="block";
    questsBox.style.display="block";
    questsContent.innerHTML="";
    dailyQuests.forEach((q,i)=>{
        questsContent.innerHTML+=`
        <p><b>${q.description}</b></p>
        <p>${Math.floor(q.progress)} / ${q.goal}</p>
        <p>Reward: ${q.rewardClicks} clicks + ${q.rewardPP} PP</p>
        <button onclick="claimQuest(${i})" ${dailyQuestsClaimed[i]?"disabled":""}>
        ${dailyQuestsClaimed[i]?"Claimed":"Claim"}
        </button><hr>`;
    });
}

function claimQuest(i){
    const q=dailyQuests[i];
    if(q.progress>=q.goal && !dailyQuestsClaimed[i]){
        x+=q.rewardClicks;
        prestigePoints+=q.rewardPP;
        dailyQuestsClaimed[i]=true;
        saveData();
    }
}

/* CLICK */
function clickHandler(){
    let gain=clickPower*rebirthMultiplier;
    if(Math.random()<critChance){gain*=3;critsTriggered++;}
    x+=gain; totalClicks+=gain;
    dailyQuests.forEach(q=>q.progress+=gain);
    saveData(); updateDisplay();
}

/* REBIRTH */
function rebirth(){
    if(x>=1000){
        rebirths++; prestigePoints++;
        rebirthMultiplier=1+Math.floor(rebirths*0.5);
        x=0; clickPower=1; autoClickers=0; critChance=0;
        saveData(); updateDisplay();
    }
}

/* SAVE */
function saveData(){
    localStorage.setItem("x",x);
    localStorage.setItem("clickPower",clickPower);
    localStorage.setItem("rebirths",rebirths);
    localStorage.setItem("rebirthMultiplier",rebirthMultiplier);
    localStorage.setItem("autoClickers",autoClickers);
    localStorage.setItem("critChance",critChance);
    localStorage.setItem("prestigePoints",prestigePoints);
    localStorage.setItem("totalClicks",totalClicks);
    localStorage.setItem("critsTriggered",critsTriggered);
    localStorage.setItem("startTime",startTime);
    localStorage.setItem("dailyQuests",JSON.stringify(dailyQuests));
    localStorage.setItem("dailyQuestsClaimed",JSON.stringify(dailyQuestsClaimed));
    localStorage.setItem("lastQuestDay",lastQuestDay);
}

/* DISPLAY */
function updateDisplay(){
    idk.innerText="Clicks: "+x;
    rebirthCounter.innerText="Rebirths: "+rebirths;
    prestigePoints.innerText="Premium Coins: "+prestigePoints;
    updateAvgCPS();
}

updateDisplay();
</script>
</body>
</html>
